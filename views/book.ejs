<%- include("partials/header") %>

<main class="container">
  <a class="btn" href="/">← Back</a>

  <article class="book-details">
    <header class="flex">
      <img class="cover" src="<%= book.cover %>" alt="Cover of <%= book.books_name %>">
      <div>
        <h1><%= book.books_name %></h1>
        <% if (book.author) { %><p><strong>Author:</strong> <%= book.author %></p><% } %>
        <% if (book.isbn)   { %><p><strong>ISBN:</strong> <%= book.isbn %></p><% } %>
        <% if (book.rating !== null && book.rating !== undefined) { %>
          <p><strong>Rating:</strong> <%= book.rating %>/10</p>
        <% } %>
        <% if (book.read_date) { %>
          <p><strong>Read:</strong> <%= new Date(book.read_date).toISOString().slice(0,10) %></p>
        <% } %>
      </div>
    </header>

    <!-- Notes section -->
    <section class="notes">
      <h2>My Notes</h2>

      <% if (book.notes) { %>
        <p><%= book.notes %></p>
      <% } else { %>
        <p class="muted">No notes yet.</p>
      <% } %>

      <form action="/books/<%= book.id %>/update-notes" method="POST">
        <textarea name="notes" rows="5" placeholder="Write your notes here..."><%= book.notes || '' %></textarea>
        <button type="submit" class="btn">💾 Save Notes</button>
      </form>
    </section>

    <p>
      <a class="btn" href="/books/<%= book.id %>/edit">✏️ Edit Meta</a>
      <form action="/books/<%= book.id %>/delete" method="POST" onsubmit="return confirm('Are you sure you want to delete this book?');">
        <button type="submit" class="btn danger">🗑 Delete</button>
      </form>
      <a class="btn" href="<%= book.buyUrl %>" target="_blank" rel="noopener">🛒 Buy</a>
    </p>
  </article>
</main>

<%- include("partials/footer") %>
