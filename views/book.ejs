<%- include("partials/header") %>

<main class="container">
  <a href="/" class="back">‚Üê Back</a>

  <div class="book-layout">
    <img class="cover big" src="<%= book.cover %>" alt="Cover">

    <div>
      <h1><%= book.books_name %></h1>
      <p class="author"><%= book.author %></p>
      <p>ISBN: <%= book.isbn || '‚Äî' %></p>
      <% if (book.store_url) { %>
        <p>
          <a class="btn buy-btn" href="<%= book.buyUrl %>" target="_blank" rel="noopener">
            üõí Buy this book
          </a>
        </p>
        
      <% } %>

      <!-- –§–û–†–ú–ê –û–ë–ù–û–í–õ–ï–ù–ò–Ø (POST /books/:id/update) -->
      <form action="/books/<%= book.id %>/update" method="post" class="notes-form">
        <label>My notes</label>
        <textarea name="notes" rows="10" placeholder="Type your thoughts..."><%= book.notes || '' %></textarea>

        <div class="two">
          <label>Rating (0‚Äì10)
            <input type="number" name="rating" min="0" max="10" value="<%= book.rating ?? '' %>">
          </label>
          <label>Read date
            <input type="date" name="read_date"
              value="<%= book.read_date
                        ? (book.read_date.toISOString
                            ? book.read_date.toISOString().slice(0,10)
                            : String(book.read_date).slice(0,10))
                        : '' %>">
          </label>
        </div>

        <label>Store link</label>
        
        <p style="margin-top:.5rem">
          <a class="btn notes-btn" href="/books/<%= book.id %>/edit">Edit</a>
          <a class="btn buy-btn" href="<%= book.buyUrl %>" target="_blank" rel="noopener">Buy this book</a>
        </p>
        <button class="btn" type="submit">Save</button>
      </form>

      <!-- –û–¢–î–ï–õ–¨–ù–ê–Ø –§–û–†–ú–ê –£–î–ê–õ–ï–ù–ò–Ø (POST /books/:id/delete) -->
      <form action="/books/<%= book.id %>/delete" method="post" style="margin-top:.5rem">
        <button class="btn danger" type="submit">Delete</button>
      </form>
    </div>
  </div>
</main>

<%- include("partials/footer") %>