# Sorting Books Read (BookNotes)

A web application for tracking books you have read.  
Users can add books, view details, edit metadata, write personal notes, and sort the list in different ways.  
Book covers are automatically fetched by ISBN using the Open Library Covers API.

## Live Demo
ðŸ‘‰ https://sorting-books-read.onrender.com

> âš ï¸ Note: The demo is hosted on Render free tier, so the first request after inactivity may take up to ~1 minute.

---

## Features
- ðŸ“š Add, view, edit, and delete books (CRUD)
- ðŸ“ Personal notes for each book
- âœï¸ Edit book metadata (title, author, ISBN)
- ðŸ”€ Sorting options: best rated, newest, by title
- ðŸ–¼ï¸ Book covers loaded automatically by ISBN
- ðŸ›’ Amazon search link generated by ISBN or title + author

---

## Tech Stack
- **Backend:** Node.js, Express
- **Database:** PostgreSQL (Neon)
- **ORM / Driver:** `pg`
- **Templates:** EJS
- **Frontend:** HTML, CSS
- **Hosting:** Render
- **External API:** Open Library Covers API

---

## Requirements
- Node.js (recommended **LTS 20.x**)
- PostgreSQL database (Neon or any other provider)

---

## Environment Variables
The app requires the following environment variable:

- `DATABASE_URL` â€” PostgreSQL connection string

Example:
postgresql://USER:PASSWORD@HOST/DBNAME?sslmode=require

---

## Local Setup

### 1) Clone the repository
```bash
git clone https://github.com/fainmariya/sorting-books-read.git
cd sorting-books-read
npm install
2) Create .env
Create a .env file in the project root:


DATABASE_URL="postgresql://USER:PASSWORD@HOST/DBNAME?sslmode=require"
You can get the connection string from Neon â†’ Connect â†’ Connection string.

3) Create database schema
Run the following SQL in your PostgreSQL database (for example in Neon SQL Editor):


CREATE TABLE IF NOT EXISTS lib_books (
  id BIGSERIAL PRIMARY KEY,
  books_name TEXT NOT NULL,
  author TEXT,
  isbn TEXT,
  read_date TIMESTAMPTZ,
  rating INTEGER CHECK (rating >= 0 AND rating <= 10),
  notes TEXT
);

CREATE INDEX IF NOT EXISTS idx_lib_books_read_date ON lib_books (read_date DESC);
CREATE INDEX IF NOT EXISTS idx_lib_books_rating ON lib_books (rating DESC);
CREATE INDEX IF NOT EXISTS idx_lib_books_name_lower ON lib_books (lower(books_name));
(Optional) Add demo data:


INSERT INTO lib_books (books_name, author, isbn, read_date, rating, notes)
VALUES
  ('Atomic Habits', 'James Clear', '9780735211292', NOW() - INTERVAL '10 days', 9, 'Very practical'),
  ('Clean Code', 'Robert C. Martin', '9780132350884', NOW() - INTERVAL '30 days', 8, 'Classic for developers');
4) Run the app

npm start
Open in browser:

http://localhost:3000
Routes
Pages
GET / â€” books list with sorting

GET /new â€” add book form

GET /books/:id â€” book details

GET /books/:id/edit â€” edit book metadata

Actions
POST /books â€” create book

POST /books/:id/update-meta â€” update title / author / ISBN

POST /books/:id/update-notes â€” save notes

POST /books/:id/delete â€” delete book

API
GET /api/books

GET /api/books/:id

POST /api/books

Healthcheck
GET /health â†’ ok

Book Covers
Book covers are loaded from Open Library Covers API using ISBN:

https://covers.openlibrary.org/b/isbn/{ISBN}-L.jpg?default=false
If no cover is found, a local placeholder image is displayed.

Deployment (Render + Neon)
Create a PostgreSQL database in Neon

Copy DATABASE_URL

In Render â†’ Service â†’ Environment, add:

DATABASE_URL = your Neon connection string

Deploy the service

Run the database schema SQL if the database is new

Troubleshooting
relation "lib_books" does not exist
The database is empty. Run the SQL schema from Create database schema.

Cannot POST /books/:id/update-meta
Ensure the route exists in index.js

Ensure edit.ejs form action matches the route

Slow first load on Render
This is expected behavior on the free tier (cold start).

Author
Mariya Fain
GitHub: https://github.com/fainmariya


